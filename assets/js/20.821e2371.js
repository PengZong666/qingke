(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{370:function(e,t,i){"use strict";i.r(t);var a=i(14),n=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[t("a",{attrs:{href:"https://www.nowcoder.com/practice/53235096538a456b9220fce120c062b3?tpId=199&tags=&title=&difficulty=0&judgeStatus=0&rp=0&sourceUrl=%2Fexam%2Foj%3Fpage%3D1%26tab%3DSQL%25E7%25AF%2587%26topicId%3D199",target:"_blank",rel:"noopener noreferrer"}},[e._v("题目来源：《牛客网-在线编程-SQL篇(34)》"),t("OutboundLink")],1)]),e._v(" "),t("h3",{attrs:{id:"明确题意"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#明确题意"}},[e._v("#")]),e._v(" 明确题意")]),e._v(" "),t("p",[e._v("题目描述有两个条件：")]),e._v(" "),t("ul",[t("li",[e._v("用户属于复旦大学 -----\x3e 通过 where 语句限定")]),e._v(" "),t("li",[e._v("用户在8月份练习 -----\x3e 通过 month 函数限定")])]),e._v(" "),t("p",[e._v("毫无疑问，我们需要将两张表进行关联！关联的时候要注意，要将8月份的条件加在关联条件中，否则可能会丢失这样一种情况“存在复旦大学用户，但是该用户在8月没有进行题目练习”")]),e._v(" "),t("div",{staticClass:"language-mysql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("SELECT \n  * \nFROM\n  user_profile AS up \n  LEFT JOIN question_practice_detail qpd \n    ON up.`device_id` = qpd.`device_id` \nWHERE up.`university` = '复旦大学' \n  AND MONTH(qpd.`date`) = 8 \n")])])]),t("p",[t("img",{attrs:{src:"https://gitee.com/PengZong888/imageSource/raw/master/img/2022/5/image-20220504104334790.png",alt:"image-20220504104334790"}})]),e._v(" "),t("p",[e._v("得到的结果缺少一行记录，还有device_id为4321的用户。")]),e._v(" "),t("div",{staticClass:"language-mysql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("SELECT \n  * \nFROM\n  user_profile AS up \n  LEFT JOIN question_practice_detail qpd \n    ON up.`device_id` = qpd.`device_id` \n    AND MONTH(qpd.`date`) = 8 \nWHERE up.`university` = '复旦大学' \n")])])]),t("p",[e._v("将month限定移动到关联条件中，这样得到的表中就会包含在8月没有进行答题的复旦大学用户了！")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/PengZong888/imageSource/raw/master/img/2022/5/image-20220504104918022.png",alt:"image-20220504104918022"}})]),e._v(" "),t("p",[e._v("题目又要求是每个用户，所以我们要对结果按 "),t("code",[e._v("device_id")]),e._v(" 进行 "),t("code",[e._v("group by")]),e._v(" 分组。再从分组之后的表中取出所需列：")]),e._v(" "),t("ul",[t("li",[e._v("device_id 不用管")]),e._v(" "),t("li",[e._v("university 通过 "),t("code",[e._v("'复旦大学' AS university")]),e._v(" 得到")]),e._v(" "),t("li",[e._v("每个用户的总题目数通过对表中"),t("code",[e._v("question_id")]),e._v("统计数量得到，即 "),t("code",[e._v("COUNT(question_id) AS question_cnt")])]),e._v(" "),t("li",[e._v("答对数量通过sum + if 得到，即"),t("code",[e._v("SUM(IF(result = 'right', 1, 0)) AS right_question_cnt")])])]),e._v(" "),t("h3",{attrs:{id:"代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#代码"}},[e._v("#")]),e._v(" 代码")]),e._v(" "),t("div",{staticClass:"language-mysql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("SELECT \n  up.`device_id`,\n  '复旦大学' AS university,\n  COUNT(question_id) AS question_cnt,\n  SUM(IF(result = 'right', 1, 0)) AS right_question_cnt \nFROM\n  user_profile AS up \n  LEFT JOIN question_practice_detail qpd \n    ON up.`device_id` = qpd.`device_id` \n    AND MONTH(qpd.`date`) = 8 \nWHERE up.`university` = '复旦大学' \nGROUP BY up.`device_id` \n")])])]),t("p",[t("img",{attrs:{src:"https://gitee.com/PengZong888/imageSource/raw/master/img/2022/5/image-20220504105408800.png",alt:"image-20220504105408800"}})])])}),[],!1,null,null,null);t.default=n.exports}}]);